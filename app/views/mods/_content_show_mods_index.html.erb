<% content.mods.order(position: :asc).each do |mod| %>
  <div class="mod-card">
    <a id="anchor-<%= mod.id %>" class='content-anchor'></a>
    <% if mod.mod_type == 'text' %>
      <div class="content-show-mods-card-text">
        <p><b><%= mod.title %></b></p>
        <p>Duration : <%= mod.duration %> min</p><br>
        <%= mod.text %>
      </div>
    <% elsif mod.mod_type == 'video' %>
      <div class="content-show-mods-card-video" style='padding:10px;'>
        <p style='padding-left: 10px;'><b><%= mod.title %></b></p>
        <p style='padding-left: 10px;'>Duration : <%= mod.duration %> min</p><br>
        <% video_id = mod.video.split("=")[1] %>
        <%= content_tag(:iframe, nil, src: "//www.youtube.com/embed/#{video_id}", allowfullscreen: "allowfullscreen") %>
      </div>
    <% elsif mod.mod_type == 'image' %>
      <div class="content-show-mods-card-image">
        <img src="<%= mod.image %>" alt="<%= mod.title %>">
      </div>
    <% elsif mod.mod_type == 'assessment' %>
      <% if params[:content_access] == 'granted' %>
        <div class="content-show-mods-card-quiz">
          <div class="quiz-info">
            <h3 style='margin-bottom: 15px;'>Assessment: <%= mod.title %></h3>
            <p>Duration : <%= mod.duration %> min</p>
          </div>
          <div class="quiz-start">
          <% if !UserForm.find_by(user_id: current_user, mod_id: mod.id).present? && mod.assessment_questions.present? %>
            <button class='btn-orange'><%= link_to 'Start Quiz', assessment_view_mode_assessment_question_path(mod, mod.assessment_questions.order(position: :asc).first), class: 'btn btn-edit-green', target: '_blank' %></button>
          <% elsif mod.assessment_questions.present? %>
            <div class="flex-row-between-centered" style='flex-direction: column'>
              <p>Grade : <%= UserForm.find_by(user_id: current_user, mod_id: mod.id)&.grade %>%</p>
              <%= link_to 'Try again', assessment_view_mode_assessment_question_path(mod, mod.assessment_questions.order(position: :asc).first), class: 'btn btn-edit-green' %>
            </div>
          <% end %>
          </div>
        </div>
      <% else %>
        <div class="content-show-mods-card-assessment" id="assessment-<%= mod.id %>">
          <%= render 'assessments/show', form: mod %>
        </div>
      <% end %>
    <% end %>
    <% if ['Super Admin', 'Admin', 'HR'].include?(current_user.access_level) && !params[:content_access].present? %>
      <% if mod.mod_type == 'text' || mod.mod_type == 'assessment' %>
        <a data-toggle='modal' data-target='#editMod-<%= mod.id %>' class='mod-edit'><i class="fas fa-pencil-alt" data-toggle='tooltip' title='Edit'></i></a>
      <% end %>
        <div class='modal fade' id='editMod-<%= mod.id %>' tabindex='-1' role='dialog' aria-labelledby='myModalLabel'  data-backdrop="static" data-keyboard="false">
          <div class='modal-dialog modal-lg' role='document' style='border-radius: 20px'>
            <% if mod.mod_type == 'text' %>
              <%= render 'mods/edit_mod_text', mod: mod %>
            <% elsif mod.mod_type = 'assessment' %>
              <%= render 'mods/edit_mod_assessment', mod: mod %>
            <% end %>
          </div>
        </div>
      <%= link_to mod_path(mod), method: :delete, class: 'mod-delete', data: {confirm: 'Are you sure ?'}, remote: true do %>
        <i class="fas fa-times" id='mod-delete' data-toggle='tooltip' title='Delete'></i>
      <% end %>
      <% if mod.position == 1 %>
        <a disabled class="mod-move-up" style='cursor: default;'>
          <i class="fas fa-arrow-up" style='color:#5B5959;'></i>
        </a>
      <% else %>
        <%= link_to move_up_mod_path(mod), class: 'mod-move-up', remote: true do %>
          <i class="fas fa-arrow-up"></i>
        <% end %>
      <% end %>
      <% if mod.position >= mod.content.mods.count %>
        <a disabled class="mod-move-down" style='cursor: default;'>
          <i class="fas fa-arrow-down" style='color:#5B5959;'></i>
        </a>
      <% else %>
        <%= link_to move_down_mod_path(mod), class: 'mod-move-down', remote: true do %>
          <i class="fas fa-arrow-down"></i>
        <% end %>
      <% end %>
    <% end %>
  </div>

<% end %>
