<div id="index-controls" class='employee-tag flex-row-between-centered'>
  <% if @filter_tags.present? %>
    <div class="filter-selected-tags">
      <h1><%= @users.count %> result(s) for</h1>
      <% @filter_tags.each do |tag| %>
        <div class="selected-tags" name='<%= tag %>'>
          <p><%= tag %></p>
          <i class="fas fa-times" onclick='removeTag(this);'></i>
        </div>
      <% end %>
    </div>
  <% else %>
    <h1>Employees (<%= @users.count %>)</h1>
  <% end %>
  <div class="index-controls-buttons flex-row-between-centered">
    <div class="btn-white" onclick='openFilter();'>
      <i class="fas fa-filter"></i>
      <p>Filter</p>
    </div>
    <div class="btn-white" id='manage-users-button' onclick='openManager();'>
      <i class="fas fa-user-tag"></i>
      <p>Manage Tags</p>
    </div>
    <div class="dropdown">
      <div class="btn-white btn-icon dropdown-toggle" id="dropdownMenu" data-toggle="dropdown">
        <i class="fas fa-ellipsis-h"></i>
      </div>
      <ul class="dropdown-menu dropdown-menu-right navbar-wagon-dropdown-menu" aria-labelledby="dropdownMenu">
        <li><a data-toggle='modal' data-target='#newUser'>New User</a></li>
        <li><a data-toggle='modal' data-target='#importUsers'>Import Users</a></li>
      </ul>
    </div>
  </div>
</div>
<div class='organisation-page' data-fl-scrolls='{"orientation": "horizontal"}'>
  <div class='organisation-users'>
    <div class='user-index-headers'>
      <div class="headers-div">
        <input type="checkbox" onclick="toggle(this);">
      </div>
      <div class="headers-div">
        <p>Name</p>
        <div class="headers-div-order">
          <%= link_to organisation_path(order: 'lastname', users: @users.map(&:id).join(','), mode: 'asc'), remote: true do %>
            <i class="fas fa-caret-up"></i>
          <% end %>
          <%= link_to organisation_path(order: 'lastname', users: @users.map(&:id).join(','), mode: 'desc'), remote: true do %>
            <i class="fas fa-caret-down"></i>
         <% end %>
        </div>
      </div>
      <div class="headers-div">
        <p>Email</p>
        <div class="headers-div-order">
          <%= link_to organisation_path(order: 'email', users: @users.map(&:id).join(','), mode: 'asc'), remote: true do %>
            <i class="fas fa-caret-up"></i>
          <% end %>
          <%= link_to organisation_path(order: 'email', users: @users.map(&:id).join(','), mode: 'desc'), remote: true do %>
            <i class="fas fa-caret-down"></i>
          <% end %>
        </div>
      </div>
      <% @tag_categories.order(position: :asc).each do |tag_category| %>
        <div class="headers-div">
          <p><%= tag_category.name %></p>
          <div class="headers-div-order">
            <%= link_to organisation_path(order: 'tag_category', tag_category_id: tag_category.id, users: @users.map(&:id).join(','), mode: 'asc'), remote: true do %>
            <i class="fas fa-caret-up"></i>
          <% end %>
          <%= link_to organisation_path(order: 'tag_category', tag_category_id: tag_category.id, users: @users.map(&:id).join(','), mode: 'desc'), remote: true do %>
            <i class="fas fa-caret-down"></i>
          <% end %>
          </div>
        </div>
      <% end %>
      <div class="headers-div">
        <i class="fas fa-plus" onclick="openForm(this);" data-toggle='tooltip' title='Add Tag Category'></i>
        <div class='hidden-form-category-ajax hidden'>
          <%= simple_form_for :tag_category, url: tag_categories_path(ajax: true), method: :post, remote: true, input_html: {multipart: true} do |f| %>
            <div class='flex-row-between-centered'>
              <%= f.text_field :name, placeholder: 'New Category', style: 'height: 100%;width:200px;' %>
              <%= f.hidden_field :users, value: @users.map(&:id) %>
              <%= f.submit '', class: 'hidden hidden-submit' %>
              <div onclick='clearInput(this);'>
                <i class="fas fa-save"></i>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
    <% @users.each do |user| %>
      <div class='user-index-card'>
        <%= render 'pages/organisation_user_card', user: user %>
      </div>
    <% end %>
  </div>
</div>
