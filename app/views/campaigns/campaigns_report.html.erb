<div class="campaigns-report-container">
  <div class='campaigns-report__temp'>
    <%= simple_form_for :select_period_temp, url: campaigns_report_path(format: :csv), method: :get do |f| %>
      <div class='report-date-control'>
        <!-- <input type="date" class='datepicker' id="start_date" name="start_date" value='<%= Date.today %>' onchange='changeDateTemp(this);'> -->
        <%= f.input :start, label: 'From', input_html: {class: 'datepicker', value: Date.today}, placeholder: 'Select date' %>
        <!-- <input type="date" class='datepicker' id="end_date" name="end_date" value='<%= Date.today.end_of_year %>' onchange='changeDateTemp(this);'> -->
        <%= f.input :end, label: 'To', input_html: {class: 'datepicker', value: Date.today.end_of_year}, placeholder: 'Select date' %>
      </div>

      <div class='campaigns-report-list__controls-export'>
        <%= button_tag type: 'submit' do %>
          <i class="fas fa-file-export"></i>
        <% end %>
      </div>
    <% end %>
  </div>
<!--   <div class="campaigns-report-managers">
    <%# render 'campaigns/partials/campaigns_report_managers', all_campaigns: @all_campaigns, campaigns: @campaigns, managers: @managers, selected_manager_id: '' %>
  </div>
  <div class="campaigns-report-index">
    <h1>All Managers</h1>
    <div class="campaigns-report-list">
      <div class="campaigns-report-list__controls">
        <%# render 'campaigns/partials/campaigns_report_controls_infos', campaigns: @campaigns, start_date: Date.today, end_date: Date.today.end_of_year %>
      </div>
      <div class="campaigns-report-list__index">
        <%# render 'campaigns/partials/campaigns_report_index', campaigns: @campaigns %>
      </div>
    </div>
  </div> -->
</div>


<!---------------->
<!-- JAVASCRIPT -->
<!---------------->

<script>

  //////////
  // TEMP //
  //////////

  function changeDateTemp(element) {
    if (element.id == 'start_date') {

    } else {

    }
  }


  //////////



  function checkDateInterval() {
    start = document.querySelector('#select_period_start')
    end = document.querySelector('#select_period_end')
    if (new Date(end.value.split('/').reverse().join('-')) < new Date(start.value.split('/').reverse().join('-'))) {
      end.value = start.value
    }
  }

  function setActiveManager(element) {
      document.querySelector('.campaigns-report-manager-card.active').classList.remove('active')
    element.classList.add('active')
    input = document.querySelector('#select_period_manager_id')
    search_input = document.querySelector('#select_period_name')
    if (element.id != '') {
      manager_id = element.id.split('-')[1]
      input.value = manager_id
    } else {
      input.value = ''
      search_input.value = ''
    }
    document.querySelector('body').classList.add('wait')
    input.closest('form').querySelector('button[type="submit"]').click()
  }

  function updateURLParameter(url, param, paramVal){
    var newAdditionalURL = "";
    var tempArray = url.split("?");
    var baseURL = tempArray[0];
    var additionalURL = tempArray[1];
    var temp = "";
    if (additionalURL) {
        tempArray = additionalURL.split("&");
        for (var i=0; i<tempArray.length; i++){
            if(tempArray[i].split('=')[0] != param){
                newAdditionalURL += temp + tempArray[i];
                temp = "&";
            }
        }
    }
    var rows_txt = temp + "" + param + "=" + paramVal;
    return baseURL + "?" + newAdditionalURL + rows_txt;
  }

  function selectManagerbyDate() {
    start = document.querySelector('#select_period_start')
    end = document.querySelector('#select_period_end')
    document.querySelectorAll('.select-manager-link').forEach((link) => {
      link.href = updateURLParameter(link.href, start.id.split('_')[2], start.value)
      link.href = updateURLParameter(link.href, end.id.split('_')[2], end.value)
    })
  }

  function autoSubmit(element) {
    form = element.closest('form')
    document.querySelector('body').classList.add('wait')
    form.querySelector('button[type="submit"]').click()
  }
</script>
