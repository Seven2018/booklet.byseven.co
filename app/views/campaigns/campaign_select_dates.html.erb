<div class="campaign-container">
  <div class="flex-row-between-centered">
    <div class="campaign-controls">
      <%= simple_form_for :campaign, url: campaign_select_template_path, method: :get do |f| %>
        <% params[:campaign].present? ? selected_template = params[:campaign][:selected_template] : selected_template = '' %>
        <% params[:campaign].present? ? selected_users = params[:campaign][:selected_users] : selected_users = '' %>
        <%= f.hidden_field :selected_template, value: selected_template %>
        <%= f.hidden_field :selected_users, value: selected_users %>
        <%= button_tag type: 'submit' do %>
            <p>Select a Template</p>
        <% end %>
      <% end %>
      <%= image_tag('arrow-next.svg', height: '20', :class => "arrow-next") %>
      <%= simple_form_for :campaign, url: campaign_select_users_path, method: :get do |f| %>
        <% params[:campaign].present? ? selected_template = params[:campaign][:selected_template] : selected_template = '' %>
        <% params[:campaign].present? ? selected_users = params[:campaign][:selected_users] : selected_users = '' %>
        <%= f.hidden_field :selected_template, value: selected_template %>
        <%= f.hidden_field :selected_users, value: selected_users %>
        <%= button_tag type: 'submit' do %>
            <p>Select Employees</p>
        <% end %>
      <% end %>
      <%= image_tag('arrow-next.svg', height: '20', :class => "arrow-next") %>
      <button class='active'><p>Select Dates</p></button>
    </div>
    <div>
      <%= link_to '', campaigns_path, class: 'confirm-button hidden' %>
      <% selected_template = InterviewForm.find(@selected_template) %>
      <%= simple_form_for Campaign.new, remote: true do |f| %>
        <%= f.hidden_field :title, value: selected_template.title %>
        <%= f.hidden_field :interview_form_id, value: selected_template.id %>
        <%= f.submit '', class: 'hidden-submit hidden' %>
      <% end %>
      <button id='campaign-confirm-button' class='btn-blue__white-border' onclick='createCampaign(this)' style='margin-top: 30px' data-toggle='tooltip'><p>Confirm</p></button>
    </div>
  </div>
  <div class="campaign-dates-container">
    <%= render 'campaigns/partials/campaign_select_dates_cards_index', selected_template: selected_template, selected_users: @selected_users %>
  </div>
</div>


<!---------------->
<!-- JAVASCRIPT -->
<!---------------->

<script>
  function createCampaign(element) {
    element.parentNode.querySelector('.hidden-submit').click()
    submit_buttons = document.querySelector('.campaign-dates-container').querySelectorAll('.hidden-submit')
    redirect_button = document.querySelector('.confirm-button')
    submit_buttons.forEach((element) => {
      setTimeout(function(){element.click()}, 500)
    })
    setTimeout(function(){redirect_button.click()}, 1000)
  }
</script>
