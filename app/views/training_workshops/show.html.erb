<div id="show-controls" class='flex-row-between-centered'>
  <%= link_to url_for(:back), class: 'btn return-arrow' do %><i class='fas fa-arrow-left'></i><% end %>
  <div id='show-buttons'>
    <%= link_to view_training_workshop_path(@training_workshop), class: 'btn btn-edit-white btn-edit-icon' do %>
      <i class="far fa-eye"></i>
    <% end %>
    <% if ['Super Admin', 'Admin', 'HR'].include? current_user.access_level %>
      <a data-toggle='modal' data-target='#editTrainingWorkshop'><button class='btn-edit-white btn-edit-icon'><i class='fas fa-pen'></i></button></a>
      <%= link_to training_workshop_path(@training_workshop), method: :delete, data: { confirm: 'Are you sure ?'} do %>
        <button class='btn-edit-white btn-edit-icon'><i class="far fa-trash-alt"></i></button>
      <% end %>
    <% end %>
  </div>
</div>
<div id="container-show">
  <div class='workshop-show-card'>
    <div class='workshop-show-card-main flex-column-centered' style="background-image: linear-gradient(to top, rgba(67, 67, 67, 0.3), rgba(0, 0, 0, 0.5)), url('<%= @training_workshop.image %>');background-position: center center;
  background-repeat: no-repeat;">
      <h2><%= @training_workshop.title %></h2>
      <h6><%= @training_workshop.workshop_type %></h6>
    </div>
    <div class="workshop-show-card-footer flex-row-between-centered">
      <div class="workshop-show-card-footer-description centered-item">
        <% if @training_workshop.workshop.author.present? %>
          <p><%= "Author: #{@training_workshop.workshop.author.fullname}" %></p>
        <% end %>
        <p><%= @training_workshop.description %></p>
      </div>
      <div class="workshop-show-card-footer-infos flex-row-around-centered">
        <div>
          <% if @training_workshop.date.present? && @training_workshop.starts_at.present? && @training_workshop.ends_at.present? %>
            <% if @training_workshop.workshop.workshop_type == 'Synchronous' %>
              <p><%= @training_workshop.date.strftime('%d/%m/%Y') %></p>
              <p><%= "#{@training_workshop.starts_at.strftime('%H:%M')} - #{@training_workshop.ends_at.strftime('%H:%M')}" %></p>
            <% else %>
              <p><%= "From #{@training_workshop.date.strftime('%d/%m/%Y')} at #{@training_workshop.starts_at.strftime('%H:%M')}" %></p>
              <% if @training_workshop.available_date.present? && @training_workshop.ends_at.present? %>
                <p><%= "To #{@training_workshop.available_date.strftime('%d/%m/%Y')} at #{@training_workshop.ends_at.strftime('%H:%M')}" %></p>
              <% end %>
            <% end %>
          <% else %>
            <p><i class="far fa-clock"></i><%= " #{@training_workshop.duration} minutes" %></p>
          <% end %>
        </div>
          <% if @training_workshop.date.present? && @training_workshop.date > Date.today %>
            <a data-toggle='modal' data-target='#inviteUsers'><button class='btn btn-invite-users'>Invite Users</button></a>
          <% else %>
            <a data-toggle='modal' data-target='#confirmPresence'><button class='btn btn-invite-users'>Confirm Presence</button></a>
          <% end %>
        <%# if @training_workshop.training_id.nil?  %>
<!--           <div>
            <%# if (!Attendee.where(training_workshop_id: @training_workshop.id, user_id: current_user, status: 'Invited').first.nil?) && @training_workshop.training_id.nil? %>
              <%# link_to 'Confirm Invitation', confirm_training_workshop_attendees_path(training_workshop_id: @training_workshop.id), class: 'btn btn-edit-orange' %>
            <%# elsif (Attendee.joins(:training_workshop).where(training_workshop_id: @training_workshop.id, user_id: current_user.id, training_workshops: {training_id: nil}).empty?) && @training_workshop.training_id.nil? %>
              <%# link_to "Register", attendees_path(training_workshop_id: @training_workshop.id, user_id: current_user.id), method: :post, class: 'btn btn-edit-green' %>
            <%# elsif (!Attendee.joins(:training_workshop).where(training_workshop_id: @training_workshop.id, user_id: current_user.id, training_workshops: {training_id: nil}).first.nil?) && @training_workshop.training_id.nil? %>
              <%# link_to "Unregister", attendee_path(Attendee.where(training_workshop_id: @training_workshop.id, user_id: current_user.id).first), method: :delete, class: 'btn btn-edit-red' %>
            <%# end %>
          </div> -->
        <%# else %>
<!--           <div>
            <%# if Attendee.where(training_workshop_id: @training_workshop.id, user_id: current_user.id).empty? %>
              <p class='btn btn-edit-red' style='cursor:default;'>Not Registered</p>
            <%# else %>
              <p class='btn btn-edit-green' style='cursor:default;'>Registered</p>
            <%# end %>
          </div> -->
        <%# end %>
      </div>
    </div>
  </div>
  <div class="workshop-show-categories">
    <% if @training_workshop.workshop.categories.present? %>
      <% @training_workshop.workshop.categories.each do |category| %>
        <h6 class="workshop-show-category-card"><%= category.title %></h6>
      <% end %>
    <% end %>
  </div>
  <% if @training_workshop.mods.present? %>
    <% @training_workshop.mods.each do |mod| %>
      <%= link_to mod_path(mod) do %>
        <div class="workshop-show-content">
          <p><%= mod.title %></p>
          <%= mod.content.html_safe %>
        </div>
      <% end %>
    <% end %>
  <% end %>
<!--   <a data-toggle='modal' data-target='#editTrainingWorkshopContent'>
    <div class="workshop-show-content-empty centered-item">
      <h3>Click to add content</h3>
    </div>
  </a> -->
</div>



<!-- Modal -->
<div class='modal fade' id='editTrainingWorkshop' tabindex='-1' role='dialog' aria-labelledby='myModalLabel'  data-backdrop="static" data-keyboard="false">
  <div class='modal-dialog modal-lg' role='document' style='border-radius: 20px'>
    <%= render 'edit', training_workshop: @training_workshop %>
  </div>
</div>

<div class='modal fade' id='editTrainingWorkshopContent' tabindex='-1' role='dialog' aria-labelledby='myModalLabel'  data-backdrop="static" data-keyboard="false">
  <div class='modal-dialog modal-lg' role='document' style='border-radius: 20px'>
    <%= render 'edit_content', training_workshop: @training_workshop %>
  </div>
</div>

<div class='modal fade' id='confirmPresence' tabindex='-1' role='dialog' aria-labelledby='myModalLabel'  data-backdrop="static" data-keyboard="false">
  <div class='modal-dialog modal-lg' role='document' style='border-radius: 20px'>
    <%= render 'attendees/confirm_presence', training_workshop: @training_workshop %>
  </div>
</div>

<div class='modal fade' id='inviteUsers' tabindex='-1' role='dialog' aria-labelledby='myModalLabel'  data-backdrop="static" data-keyboard="false">
  <div class='modal-dialog modal-lg' role='document' style='border-radius: 20px'>
    <%= render 'attendees/invite_users_to_workshop', training_workshop: @training_workshop %>
  </div>
</div>

